pipeline {
    agent any

    environment {
        SONAR_TOKEN_CREDENTIAL_ID = 'jenkinsSonar' // Replace with your credential ID
        SONAR_INSTALLATION_NAME = 'SonarScanner' // Replace with your SonarQube installation name
    }

    stages {
        stage('SonarQube Analysis') {
            steps {
                script {
                    def scannerHome = tool name: 'SonarScanner', type: 'hudson.plugins.sonar.SonarRunnerInstallation'

                    withSonarQubeEnv([string(credentialsId: SONAR_TOKEN_CREDENTIAL_ID, variable: 'SONAR_TOKEN')]) {
                        sh """${scannerHome}bin/linux-x86-64/sonar.sh -Dsonar.sources=src -Dsonar.login=\$(SONAR_TOKEN)"""

                    }
                }
            }
        }

         stage('Build Angular App') {
            steps {
                sh '''
                    #!/bin/bash
                    npm install
                    ng build --prod
                '''
            }
        }




    }
}
