pipeline {
    agent any

    environment {
        SONAR_TOKEN_CREDENTIAL_ID = 'sonar-token' // Replace with your credential ID
        SONAR_INSTALLATION_NAME = 'SonarQube' // Replace with your SonarQube installation name
    }

    stages {
        stage('SonarQube Analysis') {
            steps {
                script {
                    def scannerHome = tool name: 'SonarScanner', type: 'hudson.plugins.sonar.SonarRunnerInstallation'
                   // def SONAR_TOKEN = credentials("${SONAR_TOKEN_CREDENTIAL_ID}")
                    withSonarQubeEnv(SONAR_INSTALLATION_NAME) {
                        sh """${scannerHome}bin/linux-x86-64/ -Dsonar.sources=src -Dsonar.login=\$(SONAR_TOKEN_CREDENTIAL_ID)"""

                    }
                }
            }
        }

         stage('Build Angular App') {
            steps {
                sh '''
                    #!/bin/bash
                    npm install
                    ng build --prod
                '''
            }
        }




    }
}
